<UserControl x:Class="GPGO_MultiPLCs.Views.TotalView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:gpmodels="clr-namespace:GPMVVM.Models;assembly=GPMVVM"
             xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
             xmlns:local="clr-namespace:GPGO_MultiPLCs.Views"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:models="clr-namespace:GPGO_MultiPLCs.Models"
             xmlns:oxy="http://oxyplot.org/wpf"
             xmlns:oxyPlot="clr-namespace:OxyPlot;assembly=OxyPlot"
             xmlns:system="clr-namespace:System;assembly=mscorlib"
             xmlns:views="clr-namespace:GPMVVM.Views;assembly=GPMVVM"
             xmlns:vm="clr-namespace:GPGO_MultiPLCs.ViewModels"
             x:Name="userControl"
             d:DataContext="{d:DesignInstance vm:TotalView_ViewModel}"
             d:DesignHeight="600"
             d:DesignWidth="800"
             Foreground="{StaticResource BaseForeground}"
             mc:Ignorable="d">

    <UserControl.Resources>
        <local:TimespanToDouble x:Key="TimespanToDouble" />
        <models:EventTypeToColor x:Key="EventTypeToColor" />
        <DataTemplate x:Key="ProgressDataTemplate"
                      DataType="models:PLC_DataProvider">
            <Grid>
                <ProgressBar x:Name="Progress"
                             Maximum="1"
                             Style="{StaticResource ProgressBarNoText}"
                             Value="{Binding Progress, Mode=OneWay}" />
                <Border Background="{StaticResource DisabledBackgroundBrush}"
                        Visibility="{Binding OnlineStatus, Mode=OneWay, Converter={StaticResource BoolNotVis}}" />
                <TextBlock x:Name="ProgressString"
                           HorizontalAlignment="Center"
                           VerticalAlignment="Center"
                           Foreground="{StaticResource BaseForeground}" />
            </Grid>
            <DataTemplate.Triggers>
                <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                             Value="-1">
                    <Setter TargetName="ProgressString" Property="Foreground" Value="{StaticResource DisabledForegroundBrush}" />
                    <Setter TargetName="ProgressString" Property="Text" Value="{DynamicResource 離線}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                             Value="0">
                    <Setter TargetName="Progress" Property="Background" Value="{StaticResource WindowBackgroundBrush2}" />
                    <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource WindowBackgroundBrush4}" />
                    <Setter TargetName="ProgressString" Property="Foreground" Value="{StaticResource BaseForeground}" />
                    <Setter TargetName="ProgressString" Property="Text" Value="{DynamicResource 待命}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                             Value="1">
                    <Setter TargetName="Progress" Property="Background" Value="{StaticResource LightColorBrush}" />
                    <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource WindowBackgroundBrush4}" />
                    <Setter TargetName="ProgressString" Property="Foreground" Value="{StaticResource BaseForeground}" />
                    <Setter TargetName="ProgressString" Property="Text" Value="{DynamicResource 準備中}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                             Value="2">
                    <Setter TargetName="Progress" Property="Background" Value="Yellow" />
                    <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource EnergyBorderBrush}" />
                    <Setter TargetName="ProgressString" Property="Foreground" Value="Red" />
                    <Setter TargetName="ProgressString" Property="Text" Value="{DynamicResource 升溫中}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                             Value="3">
                    <Setter TargetName="Progress" Property="Background" Value="{StaticResource WorkingBrush}" />
                    <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource WorkingBorderBrush}" />
                    <Setter TargetName="ProgressString" Property="Foreground" Value="Red" />
                    <Setter TargetName="ProgressString" Property="Text" Value="{DynamicResource 恆溫中}" />
                </DataTrigger>
                <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                             Value="4">
                    <Setter TargetName="Progress" Property="Background" Value="{StaticResource PressedBrush}" />
                    <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource PressedBorderBrush}" />
                    <Setter TargetName="ProgressString" Property="Foreground" Value="Blue" />
                    <Setter TargetName="ProgressString" Property="Text" Value="{DynamicResource 降溫中}" />
                </DataTrigger>
            </DataTemplate.Triggers>
        </DataTemplate>
    </UserControl.Resources>

    <Grid>
        <TabControl views:TabControl.EnableSliding="True"
                    SelectedIndex="{Binding Index, Mode=TwoWay}">
            <TabItem Width="0"
                     Height="0">
                <Grid x:Name="MG">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="224" />
                    </Grid.ColumnDefinitions>
                    <ListBox Margin="3"
                             AlternationCount="2147483647"
                             ItemsSource="{Binding PLC_All, Mode=OneTime}"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                             ScrollViewer.VerticalScrollBarVisibility="Disabled"
                             SelectedIndex="{Binding ViewIndex, Mode=TwoWay}">
                        <ListBox.ItemsPanel>
                            <ItemsPanelTemplate>
                                <UniformGrid Columns="2"
                                             Rows="{Binding GT.OvenCount, Source={StaticResource AuthenticatorViewModel}, Converter={StaticResource RatioValueINT}, ConverterParameter=0.5, Mode=OneWay}" />
                            </ItemsPanelTemplate>
                        </ListBox.ItemsPanel>
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="ListBoxItem">
                                            <ContentPresenter />
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate DataType="models:PLC_DataProvider">
                                <Grid Margin="1"
                                      d:DataContext="{d:DesignInstance models:PLC_DataProvider}"
                                      Background="{StaticResource LightColorBrush}">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="{Binding (FrameworkElement.ActualHeight), Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                          MaxWidth="75" />
                                        <ColumnDefinition />
                                        <ColumnDefinition Width="{Binding (FrameworkElement.ActualHeight), Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                          MaxWidth="75" />
                                    </Grid.ColumnDefinitions>
                                    <Border Background="{StaticResource DisabledBackgroundBrush}" />
                                    <Border x:Name="StatusBorder"
                                            Grid.Column="0"
                                            Background="{StaticResource OKBrush}"
                                            Visibility="{Binding OnlineStatus, Mode=OneWay, Converter={StaticResource BoolVis}}" />
                                    <Border Grid.Column="0"
                                            Background="{StaticResource WorkingBrush}"
                                            Visibility="{Binding IsRecording, Mode=OneWay, Converter={StaticResource BoolVis}}" />
                                    <TextBlock x:Name="TextBlock"
                                               Grid.Column="0"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"
                                               FontSize="36"
                                               Foreground="{StaticResource DisabledForegroundBrush}"
                                               Text="{Binding (FrameworkElement.TemplatedParent).(ItemsControl.AlternationIndex), ConverterParameter=1, Converter={StaticResource AddValue}, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay}" />
                                    <TabControl Grid.Column="1"
                                                views:TabControl.EnableSliding="True">
                                        <TabControl.SelectedIndex>
                                            <MultiBinding Converter="{StaticResource MultiAnyTrueConverterToInt}"
                                                          Mode="OneWay">
                                                <Binding ElementName="ActiveToggle"
                                                         Mode="OneWay"
                                                         Path="IsChecked" />
                                                <Binding Mode="OneWay"
                                                         Path="IsRecording" />
                                            </MultiBinding>
                                        </TabControl.SelectedIndex>
                                        <TabItem Width="0"
                                                 Height="0"
                                                 FontSize="14">
                                            <Grid TextElement.Foreground="{StaticResource BaseForeground}">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="60" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Border Background="{StaticResource WindowBackgroundBrush6}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,0,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{DynamicResource 財產編號}" />
                                                </Border>
                                                <Border Grid.Row="1"
                                                        Grid.Column="0"
                                                        Background="{StaticResource WindowBackgroundBrush6}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,1,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{DynamicResource 配方}" />
                                                </Border>
                                                <UniformGrid Grid.Row="0"
                                                             Grid.Column="1"
                                                             Rows="1">
                                                    <TextBox BorderThickness="0"
                                                             Focusable="{Binding IsHitTestVisible, RelativeSource={RelativeSource Self}}"
                                                             GotKeyboardFocus="TextBox_GotKeyboardFocus"
                                                             IsHitTestVisible="{Binding NowUser.Level, Source={StaticResource AuthenticatorViewModel}, Converter={StaticResource IsMoreThanValue}, ConverterParameter=3}"
                                                             Text="{Binding OvenInfo.AssetNumber, Mode=TwoWay}" />
                                                    <TextBox BorderThickness="0"
                                                             Focusable="{Binding IsHitTestVisible, RelativeSource={RelativeSource Self}}"
                                                             GotKeyboardFocus="TextBox_GotKeyboardFocus"
                                                             IsHitTestVisible="{Binding NowUser.Level, Source={StaticResource AuthenticatorViewModel}, Converter={StaticResource IsMoreThanValue}, ConverterParameter=3}"
                                                             Text="{Binding OvenInfo.MachineCode, Mode=TwoWay}"
                                                             Visibility="{Binding IsHitTestVisible, Converter={StaticResource BoolVis}, Mode=OneWay, RelativeSource={RelativeSource Self}}" />
                                                </UniformGrid>
                                                <ComboBox Grid.Row="1"
                                                          Grid.Column="1"
                                                          BorderThickness="0,1,0,0"
                                                          GotKeyboardFocus="CB_GotKeyboardFocus"
                                                          IsEditable="{Binding IsEnabled, Mode=OneWay, RelativeSource={RelativeSource Self}}"
                                                          IsHitTestVisible="{Binding IsEnabled, Mode=OneWay, RelativeSource={RelativeSource Self}}"
                                                          IsTextSearchEnabled="False"
                                                          ItemsSource="{Binding Recipe_Names, Mode=OneWay}"
                                                          LostKeyboardFocus="CB_LostKeyboardFocus"
                                                          SelectedItem="{Binding Selected_Name, Mode=TwoWay}"
                                                          Text="{Binding Intput_Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                                    <i:Interaction.Triggers>
                                                        <!--  因為在combobox的選單出現時，enter會優先處裡選單，keydown事件會無法偵測enter，因此必須在keyup的時候才檢查enter  -->
                                                        <i:EventTrigger EventName="KeyUp">
                                                            <gpmodels:InteractiveCommand Command="{Binding CheckRecipeCommand_KeyIn, Mode=OneTime}" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                    <ComboBox.IsEnabled>
                                                        <MultiBinding Converter="{StaticResource MultiBooleanConverter}">
                                                            <Binding Converter="{StaticResource IsMoreThanValue}"
                                                                     ConverterParameter="1"
                                                                     Mode="OneWay"
                                                                     Path="NowUser.Level"
                                                                     Source="{StaticResource AuthenticatorViewModel}" />
                                                            <Binding Converter="{StaticResource BoolNot}"
                                                                     Mode="OneWay"
                                                                     Path="AutoMode" />
                                                            <Binding Mode="OneWay"
                                                                     Path="OnlineStatus" />
                                                        </MultiBinding>
                                                    </ComboBox.IsEnabled>
                                                    <ComboBox.ItemTemplate>
                                                        <DataTemplate>
                                                            <TextBlock Text="{Binding Mode=OneWay}"
                                                                       TextTrimming="CharacterEllipsis" />
                                                        </DataTemplate>
                                                    </ComboBox.ItemTemplate>
                                                </ComboBox>
                                            </Grid>
                                        </TabItem>
                                        <TabItem Width="0"
                                                 Height="0">
                                            <Grid>
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="60" />
                                                    <ColumnDefinition />
                                                    <ColumnDefinition Width="60" />
                                                    <ColumnDefinition />
                                                </Grid.ColumnDefinitions>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Border Background="{StaticResource WindowBackgroundBrush6}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,0,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{DynamicResource 操作員}" />
                                                </Border>
                                                <Border Grid.Row="0"
                                                        Grid.Column="1"
                                                        Background="{StaticResource LightColorBrush}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,0,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{Binding OvenInfo.OperatorID, Mode=OneWay}" />
                                                </Border>
                                                <Border Grid.Row="1"
                                                        Grid.Column="0"
                                                        Background="{StaticResource WindowBackgroundBrush6}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,1,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{DynamicResource 台車}" />
                                                </Border>
                                                <Border Grid.Row="1"
                                                        Grid.Column="1"
                                                        Background="{StaticResource LightColorBrush}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,1,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{Binding OvenInfo.TrolleyCode, Mode=OneWay}" />
                                                </Border>
                                                <Border x:Name="Border1"
                                                        Grid.Row="0"
                                                        Grid.Column="2"
                                                        Background="{StaticResource WindowBackgroundBrush6}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,0,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{DynamicResource 狀態}" />
                                                </Border>
                                                <Border Grid.Row="0"
                                                        Grid.Column="3"
                                                        Background="{StaticResource LightColorBrush}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,0,0,0">
                                                    <ContentControl Content="{Binding Mode=OneWay}"
                                                                    ContentTemplate="{StaticResource ProgressDataTemplate}" />
                                                </Border>
                                                <Border Grid.Row="1"
                                                        Grid.Column="0"
                                                        Background="{StaticResource WindowBackgroundBrush6}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,1,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{DynamicResource 台車}" />
                                                </Border>
                                                <Border Grid.Row="1"
                                                        Grid.Column="2"
                                                        Background="{StaticResource WindowBackgroundBrush6}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,1,1,0">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               Text="{DynamicResource 數量}" />
                                                </Border>
                                                <Border Grid.Row="1"
                                                        Grid.Column="3"
                                                        Background="{StaticResource LightColorBrush}"
                                                        BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                        BorderThickness="0,1,0,0">
                                                    <Grid Background="Transparent">
                                                        <ToggleButton x:Name="ToggleButton"
                                                                      Margin="0,0,4,0"
                                                                      Content="{Binding ProcessCounts, Mode=OneWay}"
                                                                      Style="{StaticResource ArrowToggle}">
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName="MouseLeave">
                                                                    <views:SetPropertyAction PropertyName="IsChecked">
                                                                        <views:SetPropertyAction.PropertyValue>
                                                                            <system:Boolean>False</system:Boolean>
                                                                        </views:SetPropertyAction.PropertyValue>
                                                                    </views:SetPropertyAction>
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                        </ToggleButton>
                                                        <Popup AllowsTransparency="True"
                                                               Focusable="False"
                                                               IsHitTestVisible="False"
                                                               IsOpen="{Binding IsChecked, ElementName=ToggleButton, Mode=OneWay}"
                                                               Placement="Center"
                                                               PopupAnimation="Fade">
                                                            <Border x:Name="Border"
                                                                    Background="Transparent">
                                                                <DataGrid Margin="15"
                                                                          AlternationCount="2147483647"
                                                                          AutoGenerateColumns="False"
                                                                          BorderThickness="1,1,0,0"
                                                                          HorizontalScrollBarVisibility="Disabled"
                                                                          IsHitTestVisible="False"
                                                                          ItemsSource="{Binding Ext_Info, Mode=OneWay}"
                                                                          RowHeaderTemplate="{StaticResource ShowRowNumbers}"
                                                                          VerticalScrollBarVisibility="Disabled">
                                                                    <DataGrid.Effect>
                                                                        <DropShadowEffect BlurRadius="15"
                                                                                          Direction="270"
                                                                                          Opacity="0.25" />
                                                                    </DataGrid.Effect>
                                                                    <DataGrid.Columns>
                                                                        <DataGridTemplateColumn Width="Auto">
                                                                            <DataGridTemplateColumn.Header>
                                                                                <TextBlock Text="{DynamicResource 工單}" />
                                                                            </DataGridTemplateColumn.Header>
                                                                            <DataGridTemplateColumn.CellTemplate>
                                                                                <DataTemplate DataType="models:ProductInfo">
                                                                                    <TextBlock Margin="4"
                                                                                               HorizontalAlignment="Center"
                                                                                               VerticalAlignment="Center"
                                                                                               Text="{Binding OrderCode, Mode=OneWay}"
                                                                                               TextTrimming="CharacterEllipsis" />
                                                                                </DataTemplate>
                                                                            </DataGridTemplateColumn.CellTemplate>
                                                                        </DataGridTemplateColumn>
                                                                        <DataGridTemplateColumn>
                                                                            <DataGridTemplateColumn.Header>
                                                                                <TextBlock Text="{DynamicResource 製程序}" />
                                                                            </DataGridTemplateColumn.Header>
                                                                            <DataGridTemplateColumn.CellTemplate>
                                                                                <DataTemplate DataType="models:ProductInfo">
                                                                                    <TextBlock Margin="4"
                                                                                               HorizontalAlignment="Center"
                                                                                               VerticalAlignment="Center"
                                                                                               Text="{Binding ProcessNumber, Mode=OneWay, StringFormat=\{0:D3\}}"
                                                                                               TextTrimming="CharacterEllipsis" />
                                                                                </DataTemplate>
                                                                            </DataGridTemplateColumn.CellTemplate>
                                                                        </DataGridTemplateColumn>
                                                                        <DataGridTemplateColumn Width="Auto">
                                                                            <DataGridTemplateColumn.Header>
                                                                                <TextBlock Text="{DynamicResource 數量}" />
                                                                            </DataGridTemplateColumn.Header>
                                                                            <DataGridTemplateColumn.CellStyle>
                                                                                <Style TargetType="{x:Type DataGridCell}">
                                                                                    <Setter Property="KeyboardNavigation.TabNavigation" Value="None" />
                                                                                    <Setter Property="Template">
                                                                                        <Setter.Value>
                                                                                            <ControlTemplate TargetType="{x:Type DataGridCell}">
                                                                                                <ContentPresenter />
                                                                                            </ControlTemplate>
                                                                                        </Setter.Value>
                                                                                    </Setter>
                                                                                </Style>
                                                                            </DataGridTemplateColumn.CellStyle>
                                                                            <DataGridTemplateColumn.CellTemplate>
                                                                                <DataTemplate DataType="models:ProductInfo">
                                                                                    <Grid>
                                                                                        <Grid.RowDefinitions>
                                                                                            <RowDefinition Height="Auto" />
                                                                                            <RowDefinition Height="Auto" />
                                                                                        </Grid.RowDefinitions>
                                                                                        <Border Padding="4"
                                                                                                BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                                                                BorderThickness="0,0,0,1">
                                                                                            <TextBlock HorizontalAlignment="Center"
                                                                                                       Text="{Binding PanelCodes.Count, Mode=OneWay}" />
                                                                                        </Border>
                                                                                        <ItemsControl x:Name="ItemsControl"
                                                                                                      Grid.Row="1"
                                                                                                      AlternationCount="2147483647"
                                                                                                      ItemsSource="{Binding PanelCodes, Mode=OneWay}">
                                                                                            <ItemsControl.Template>
                                                                                                <ControlTemplate>
                                                                                                    <Border Background="{StaticResource LightColorBrush}"
                                                                                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                                                                            BorderThickness="0">
                                                                                                        <ItemsPresenter />
                                                                                                    </Border>
                                                                                                </ControlTemplate>
                                                                                            </ItemsControl.Template>
                                                                                            <ItemsControl.ItemsPanel>
                                                                                                <ItemsPanelTemplate>
                                                                                                    <views:UniformGridWithOrientation Margin="0,-1,0,0"
                                                                                                                                      Orientation="Vertical"
                                                                                                                                      Rows="10" />
                                                                                                </ItemsPanelTemplate>
                                                                                            </ItemsControl.ItemsPanel>
                                                                                            <ItemsControl.ItemTemplate>
                                                                                                <DataTemplate>
                                                                                                    <Grid MinHeight="20"
                                                                                                          TextElement.Foreground="{StaticResource BaseForeground}">
                                                                                                        <Grid.ColumnDefinitions>
                                                                                                            <ColumnDefinition Width="30" />
                                                                                                            <ColumnDefinition />
                                                                                                        </Grid.ColumnDefinitions>
                                                                                                        <Border BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                                                                                BorderThickness="0,1,1,0">
                                                                                                            <TextBlock HorizontalAlignment="Center"
                                                                                                                       VerticalAlignment="Center"
                                                                                                                       FontSize="12"
                                                                                                                       Text="{Binding (ItemsControl.AlternationIndex), ConverterParameter=1, Converter={StaticResource AddValue}, RelativeSource={RelativeSource TemplatedParent}, Mode=OneTime}" />
                                                                                                        </Border>
                                                                                                        <Border Grid.Column="1"
                                                                                                                Background="Transparent"
                                                                                                                BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                                                                                BorderThickness="0,1,1,0">
                                                                                                            <TextBlock Margin="4,0"
                                                                                                                       HorizontalAlignment="Center"
                                                                                                                       VerticalAlignment="Center"
                                                                                                                       FontSize="12"
                                                                                                                       Text="{Binding Mode=OneWay}" />
                                                                                                        </Border>
                                                                                                    </Grid>
                                                                                                </DataTemplate>
                                                                                            </ItemsControl.ItemTemplate>
                                                                                        </ItemsControl>
                                                                                    </Grid>
                                                                                </DataTemplate>
                                                                            </DataGridTemplateColumn.CellTemplate>
                                                                        </DataGridTemplateColumn>
                                                                    </DataGrid.Columns>
                                                                </DataGrid>
                                                            </Border>
                                                            <Popup.VerticalOffset>
                                                                <MultiBinding Converter="{StaticResource SumValueConverter}">
                                                                    <Binding Converter="{StaticResource RatioValue}"
                                                                             ConverterParameter="0.5"
                                                                             ElementName="Border"
                                                                             Path="ActualHeight" />
                                                                    <Binding Converter="{StaticResource RatioValue}"
                                                                             ConverterParameter="0.5"
                                                                             ElementName="ToggleButton"
                                                                             Path="ActualHeight" />
                                                                </MultiBinding>
                                                            </Popup.VerticalOffset>
                                                        </Popup>
                                                    </Grid>
                                                </Border>
                                            </Grid>
                                        </TabItem>
                                    </TabControl>
                                    <ToggleButton x:Name="ActiveToggle"
                                                  Grid.Row="0"
                                                  Grid.Column="2"
                                                  Content="{DynamicResource 投產}"
                                                  FontSize="20"
                                                  IsChecked="{Binding CheckInCommand.Result, Mode=OneWay}">
                                        <ToggleButton.IsEnabled>
                                            <MultiBinding Converter="{StaticResource MultiBooleanConverter}">
                                                <Binding Converter="{StaticResource BoolNot}"
                                                         Mode="OneWay"
                                                         Path="IsRecording" />
                                                <Binding Converter="{StaticResource IsMoreThanValue}"
                                                         ConverterParameter="1"
                                                         Mode="OneWay"
                                                         Path="NowUser.Level"
                                                         Source="{StaticResource AuthenticatorViewModel}" />
                                                <Binding Mode="OneWay"
                                                         Path="OnlineStatus" />
                                            </MultiBinding>
                                        </ToggleButton.IsEnabled>
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Checked">
                                                <i:InvokeCommandAction Command="{Binding CheckInCommand, Mode=OneTime}"
                                                                       CommandParameter="{Binding Text, ElementName=TextBlock, Mode=OneWay}" />
                                            </i:EventTrigger>
                                            <i:EventTrigger EventName="Unchecked">
                                                <i:InvokeCommandAction Command="{Binding CancelCheckInCommand, Mode=OneTime}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ToggleButton>
                                </Grid>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding AutoMode, Mode=OneWay}"
                                                 Value="True">
                                        <Setter TargetName="StatusBorder" Property="Background" Value="{StaticResource PressedBrush}" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsChecked, ElementName=ActiveToggle, Mode=OneWay}"
                                                 Value="True">
                                        <Setter TargetName="ActiveToggle" Property="Content" Value="{DynamicResource 取消}" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding OnlineStatus, Mode=OneWay}"
                                                 Value="True">
                                        <Setter TargetName="TextBlock" Property="Foreground" Value="White" />
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsRecording, Mode=OneWay}">
                                        <Setter TargetName="ActiveToggle" Property="Content" Value="{Binding Progress, StringFormat=\{0:P\}, Mode=OneWay}" />
                                        <Setter TargetName="ActiveToggle" Property="IsEnabled" Value="False" />
                                        <Setter TargetName="TextBlock" Property="Foreground" Value="{StaticResource BaseForeground}" />
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    <Grid Grid.Column="1"
                          Background="{StaticResource WindowBackgroundBrush2}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="4" />
                            <RowDefinition Height="40" />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <Grid>
                            <Rectangle Fill="{StaticResource DisabledBackgroundBrush}"
                                       Stroke="{StaticResource DisabledBorderBrush}"
                                       StrokeThickness="0" />
                            <Rectangle Fill="{StaticResource OKBrush}"
                                       Stroke="{StaticResource OKBorderBrush}"
                                       StrokeThickness="0"
                                       Visibility="{Binding Gate_Status, Mode=OneWay, Converter={StaticResource BoolVis}}" />
                        </Grid>
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="PreviewMouseDown">
                                    <i:InvokeCommandAction Command="{Binding StartLog, Source={StaticResource AuthenticatorViewModel}, Mode=OneTime}" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                            <Border Background="{StaticResource LightColorBrush}"
                                    BorderBrush="{StaticResource WindowBackgroundBrush4}">
                                <TextBlock Margin="4,0"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           FontSize="16"
                                           Text="{Binding NowUser.Name, Source={StaticResource AuthenticatorViewModel}, Mode=OneWay}" />
                            </Border>
                            <Border Grid.Column="1">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="LightSlateGray" />
                                        <Setter Property="Width" Value="{Binding ActualHeight, Mode=OneWay, RelativeSource={RelativeSource Self}}" />
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding NowUser.Level, Source={StaticResource AuthenticatorViewModel}, Mode=OneWay}"
                                                         Value="1">
                                                <Setter Property="Background" Value="Green" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding NowUser.Level, Source={StaticResource AuthenticatorViewModel}, Mode=OneWay}"
                                                         Value="2">
                                                <Setter Property="Background" Value="Blue" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding NowUser.Level, Source={StaticResource AuthenticatorViewModel}, Mode=OneWay}"
                                                         Value="3">
                                                <Setter Property="Background" Value="Purple" />
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding NowUser.Level, Source={StaticResource AuthenticatorViewModel}, Mode=OneWay}"
                                                         Value="4">
                                                <Setter Property="Background" Value="{StaticResource EnergyBrush}" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <TextBlock HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           FontSize="18"
                                           FontWeight="Bold"
                                           Foreground="White"
                                           Text="{Binding NowUser.Level, Source={StaticResource AuthenticatorViewModel}, Mode=OneWay, Converter={StaticResource SubHeadString}, ConverterParameter=2}" />
                            </Border>
                        </Grid>
                        <Grid Grid.Row="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="30" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Border Background="{StaticResource WindowBackgroundBrush6}"
                                    BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                    BorderThickness="0,1,0,1">
                                <TextBlock HorizontalAlignment="Center"
                                           VerticalAlignment="Center">
                                    <Run Text="{DynamicResource 本日產量}" />
                                    <Run Text=": " />
                                    <Run Text="{Binding TotalProductionCount, Mode=OneWay}" />
                                    <Run Text="panels" />
                                </TextBlock>
                            </Border>
                            <oxy:Plot Grid.Row="1"
                                      Background="{StaticResource WindowBackgroundBrush6}"
                                      DefaultFont="Microsoft JhengHei"
                                      IsMouseWheelEnabled="False"
                                      LegendBackground="{Binding Color, Source={StaticResource LightColorBrush}}"
                                      LegendBorder="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                      LegendBorderThickness="1"
                                      LegendFontSize="12"
                                      LegendItemOrder="Reverse"
                                      LegendItemSpacing="10"
                                      LegendOrientation="Horizontal"
                                      LegendPlacement="Outside"
                                      LegendPosition="TopCenter"
                                      LegendTextColor="{Binding Color, Source={StaticResource BaseForeground}}"
                                      LegendTitleColor="{Binding Color, Source={StaticResource BaseForeground}}"
                                      PlotAreaBackground="{StaticResource LightColorBrush}"
                                      PlotAreaBorderColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                      PlotAreaBorderThickness="1,1,1,0"
                                      PlotMargins="40,-10,0,20"
                                      TextColor="{Binding Color, Source={StaticResource BaseForeground}}">
                                <oxy:Plot.Axes>
                                    <oxy:LinearAxis AxislineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                    AxislineStyle="Solid"
                                                    ExtraGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                    ExtraGridlineStyle="Solid"
                                                    ExtraGridlineThickness="1"
                                                    IsPanEnabled="False"
                                                    IsZoomEnabled="False"
                                                    MajorGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                    MajorGridlineStyle="Dot"
                                                    MaximumPadding="0.28"
                                                    Minimum="0"
                                                    MinimumPadding="0"
                                                    MinorGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                    MinorGridlineStyle="None"
                                                    Position="Bottom"
                                                    TickStyle="Inside"
                                                    TicklineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                    TitleColor="{Binding Color, Source={StaticResource BaseForeground}}" />
                                    <oxy:CategoryAxis x:Name="CA"
                                                      AxislineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                      AxislineStyle="Solid"
                                                      EndPosition="0"
                                                      ExtraGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                      ExtraGridlineStyle="None"
                                                      ExtraGridlineThickness="0"
                                                      GapWidth="1"
                                                      IsPanEnabled="False"
                                                      IsZoomEnabled="False"
                                                      MajorGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                      MajorGridlineStyle="None"
                                                      MinorGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                      MinorGridlineStyle="None"
                                                      Position="Left"
                                                      StartPosition="1"
                                                      TickStyle="Inside"
                                                      TicklineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                      TitleColor="{Binding Color, Source={StaticResource BaseForeground}}" />
                                </oxy:Plot.Axes>
                                <oxy:Plot.Series>
                                    <oxy:BarSeries x:Name="BS"
                                                   FillColor="Cyan"
                                                   ItemsSource="{Binding TotalProduction_View, Mode=OneWay}"
                                                   LabelFormatString="{}{0}"
                                                   LabelMargin="4"
                                                   LabelPlacement="Outside"
                                                   StrokeColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                   StrokeThickness="1"
                                                   ValueField="Value" />
                                </oxy:Plot.Series>
                                <oxy:Plot.DefaultTrackerTemplate>
                                    <ControlTemplate>
                                        <oxy:TrackerControl d:DataContext="{d:DesignInstance oxy:TrackerControl}"
                                                            Background="{StaticResource LightBrush}"
                                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                            BorderThickness="1"
                                                            CornerRadius="0"
                                                            HorizontalLineVisibility="Collapsed"
                                                            LineExtents="{Binding (oxyPlot:PlotElement.PlotModel).PlotArea}"
                                                            LineStroke="DeepSkyBlue"
                                                            Position="{Binding Position}">
                                            <oxy:TrackerControl.Content>
                                                <TextBlock Margin="4"
                                                           Foreground="{StaticResource BaseForeground}"
                                                           Text="{Binding Mode=OneWay}" />
                                            </oxy:TrackerControl.Content>
                                        </oxy:TrackerControl>
                                    </ControlTemplate>
                                </oxy:Plot.DefaultTrackerTemplate>
                            </oxy:Plot>
                        </Grid>
                    </Grid>
                </Grid>
            </TabItem>
            <TabItem Width="0"
                     Height="0">
                <Grid Background="{StaticResource WindowBackgroundBrush}">
                    <Grid.RowDefinitions>
                        <RowDefinition />
                        <RowDefinition Height="50" />
                    </Grid.RowDefinitions>
                    <Grid DataContext="{Binding PLC_In_Focused, Mode=OneWay}">
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition Height="290" />
                        </Grid.RowDefinitions>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*" />
                                <ColumnDefinition />
                            </Grid.ColumnDefinitions>
                            <GroupBox Margin="4,4,2,4"
                                      Header="{DynamicResource 配方參數}"
                                      IsHitTestVisible="False">
                                <local:AutoGrid ClipToBounds="True"
                                                Columns="75,*,75,*,75,*,75,*"
                                                Orientation="Vertical"
                                                RowCount="9">
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock Margin="4,0"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 配方}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 目標溫度}" />
                                            <Run Text="1" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 目標溫度}" />
                                            <Run Text="2" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 目標溫度}" />
                                            <Run Text="3" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 目標溫度}" />
                                            <Run Text="4" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 目標溫度}" />
                                            <Run Text="5" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 目標溫度}" />
                                            <Run Text="6" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 目標溫度}" />
                                            <Run Text="7" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 目標溫度}" />
                                            <Run Text="8" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding RecipeName, Mode=OneWay}"
                                                   TextTrimming="CharacterEllipsis" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding TargetTemperature_1, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding TargetTemperature_2, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding TargetTemperature_3, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding TargetTemperature_4, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding TargetTemperature_5, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding TargetTemperature_6, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding TargetTemperature_7, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding TargetTemperature_8, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 使用段數}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 升溫時間}" />
                                            <Run Text="1" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 升溫時間}" />
                                            <Run Text="2" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 升溫時間}" />
                                            <Run Text="3" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 升溫時間}" />
                                            <Run Text="4" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 升溫時間}" />
                                            <Run Text="5" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 升溫時間}" />
                                            <Run Text="6" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 升溫時間}" />
                                            <Run Text="7" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 升溫時間}" />
                                            <Run Text="8" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding UsedSegmentCounts, Mode=OneWay}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding HeatingTime_1, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding HeatingTime_2, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding HeatingTime_3, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding HeatingTime_4, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding HeatingTime_5, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding HeatingTime_6, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding HeatingTime_7, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding HeatingTime_8, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 降溫溫度}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫溫度}" />
                                            <Run Text="1" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫溫度}" />
                                            <Run Text="2" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫溫度}" />
                                            <Run Text="3" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫溫度}" />
                                            <Run Text="4" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫溫度}" />
                                            <Run Text="5" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫溫度}" />
                                            <Run Text="6" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫溫度}" />
                                            <Run Text="7" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫溫度}" />
                                            <Run Text="8" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding CoolingTemperature, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostaticTemperature_1, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostaticTemperature_2, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostaticTemperature_3, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostaticTemperature_4, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostaticTemperature_5, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostaticTemperature_6, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostaticTemperature_7, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostaticTemperature_8, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 充氣時間}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫時間}" />
                                            <Run Text="1" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫時間}" />
                                            <Run Text="2" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫時間}" />
                                            <Run Text="3" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫時間}" />
                                            <Run Text="4" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫時間}" />
                                            <Run Text="5" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫時間}" />
                                            <Run Text="6" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫時間}" />
                                            <Run Text="7" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{DynamicResource 恆溫時間}" />
                                            <Run Text="8" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding InflatingTime, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding WarmingTime_1, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding WarmingTime_2, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding WarmingTime_3, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding WarmingTime_4, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding WarmingTime_5, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding WarmingTime_6, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding WarmingTime_7, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding WarmingTime_8, Mode=OneWay}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                </local:AutoGrid>
                            </GroupBox>
                            <GroupBox Grid.Column="1"
                                      Margin="2,4,4,4"
                                      Header="{DynamicResource 設備狀態}"
                                      IsHitTestVisible="False">
                                <local:AutoGrid Columns="75,*,75,*"
                                                Orientation="Vertical"
                                                RowCount="9">
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock x:Name="Text0"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 溫控器溫度}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 爐內溫度1}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 爐內溫度2}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 爐內溫度3}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 爐內溫度4}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 爐內溫度5}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 爐內溫度6}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 爐內溫度7}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 爐內溫度8}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding ThermostatTemperature, Mode=OneWay, StringFormat=\{0:F1\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding OvenTemperature_1, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding OvenTemperature_2, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding OvenTemperature_3, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding OvenTemperature_4, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding OvenTemperature_5, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding OvenTemperature_6, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding OvenTemperature_7, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{Binding OvenTemperature_8, Mode=OneWay, StringFormat=\{0:D\} °C}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 設備模式}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 生產結束}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 緊急停止}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 溫度異常}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 風車異常}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 充氣逾時}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 升恆溫逾時}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 狀態}" />
                                    </Border>
                                    <Border Background="{StaticResource WindowBackgroundBrush6}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,1,1">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 剩餘}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <TabControl views:TabControl.EnableSliding="True"
                                                    SelectedIndex="{Binding AutoMode, Mode=OneWay}">
                                            <TabItem Width="0"
                                                     Height="0">
                                                <Border Background="{StaticResource OKBrush}">
                                                    <TextBlock HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"
                                                               FontSize="16"
                                                               Foreground="White"
                                                               Text="{DynamicResource 手動}" />
                                                </Border>
                                            </TabItem>
                                            <TabItem Width="0"
                                                     Height="0">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition />
                                                        <ColumnDefinition Width="8" />
                                                    </Grid.ColumnDefinitions>
                                                    <Border Background="{StaticResource PressedBrush}">
                                                        <TextBlock HorizontalAlignment="Center"
                                                                   VerticalAlignment="Center"
                                                                   FontSize="16"
                                                                   Foreground="White"
                                                                   Text="{DynamicResource 自動}" />
                                                    </Border>
                                                    <Border Grid.Column="1"
                                                            Background="{StaticResource DisabledBackgroundBrush}"
                                                            BorderBrush="{StaticResource DisabledBorderBrush}"
                                                            BorderThickness="1" />
                                                    <Border Grid.Column="1"
                                                            Background="{StaticResource WorkingBrush}"
                                                            BorderBrush="{StaticResource WorkingBorderBrush}"
                                                            BorderThickness="1"
                                                            Visibility="{Binding AutoMode_Start, Converter={StaticResource BoolVis}, Mode=OneWay}" />
                                                </Grid>
                                            </TabItem>
                                        </TabControl>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <CheckBox Background="Cyan"
                                                  BorderBrush="{StaticResource PressedBrush}"
                                                  Content="{Binding IsChecked, Mode=OneWay, RelativeSource={RelativeSource Self}, Converter={StaticResource BoolOnOff}}"
                                                  IsChecked="{Binding ProgramStop, Mode=OneWay}"
                                                  Style="{StaticResource SignalView}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <CheckBox Background="{StaticResource ErrorBrush}"
                                                  BorderBrush="{StaticResource ErrorBorderBrush}"
                                                  Content="{Binding IsChecked, Mode=OneWay, RelativeSource={RelativeSource Self}, Converter={StaticResource BoolOnOff}}"
                                                  IsChecked="{Binding EmergencyStop, Mode=OneWay}"
                                                  Style="{StaticResource SignalView}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <CheckBox Background="{StaticResource ErrorBrush}"
                                                  BorderBrush="{StaticResource ErrorBorderBrush}"
                                                  Content="{Binding IsChecked, Mode=OneWay, RelativeSource={RelativeSource Self}, Converter={StaticResource BoolOnOff}}"
                                                  Style="{StaticResource SignalView}">
                                            <CheckBox.IsChecked>
                                                <MultiBinding Converter="{StaticResource MultiAnyTrueConverter}">
                                                    <Binding Mode="OneWay"
                                                             Path="LowTemperature" />
                                                    <Binding Mode="OneWay"
                                                             Path="OTP_TemperatureError" />
                                                    <Binding Mode="OneWay"
                                                             Path="OverTemperatureAlarm" />
                                                </MultiBinding>
                                            </CheckBox.IsChecked>
                                        </CheckBox>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <CheckBox Background="{StaticResource ErrorBrush}"
                                                  BorderBrush="{StaticResource ErrorBorderBrush}"
                                                  Content="{Binding IsChecked, Mode=OneWay, RelativeSource={RelativeSource Self}, Converter={StaticResource BoolOnOff}}"
                                                  Style="{StaticResource SignalView}">
                                            <CheckBox.IsChecked>
                                                <MultiBinding Converter="{StaticResource MultiAnyTrueConverter}">
                                                    <Binding Mode="OneWay"
                                                             Path="CirculatingFanOverload" />
                                                    <Binding Mode="OneWay"
                                                             Path="CoolingFanAbnormal" />
                                                    <Binding Mode="OneWay"
                                                             Path="CirculatingFanInversion" />
                                                </MultiBinding>
                                            </CheckBox.IsChecked>
                                        </CheckBox>
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <CheckBox Background="{StaticResource ErrorBrush}"
                                                  BorderBrush="{StaticResource ErrorBorderBrush}"
                                                  Content="{Binding IsChecked, Mode=OneWay, RelativeSource={RelativeSource Self}, Converter={StaticResource BoolOnOff}}"
                                                  IsChecked="{Binding InflatingTimeExceeded, Mode=OneWay}"
                                                  Style="{StaticResource SignalView}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <CheckBox Background="{StaticResource ErrorBrush}"
                                                  BorderBrush="{StaticResource ErrorBorderBrush}"
                                                  Content="{Binding IsChecked, Mode=OneWay, RelativeSource={RelativeSource Self}, Converter={StaticResource BoolOnOff}}"
                                                  IsChecked="{Binding HeatingTimeExceeded, Mode=OneWay}"
                                                  Style="{StaticResource SignalView}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0,0,0,1">
                                        <ContentControl Content="{Binding Mode=OneWay}"
                                                        ContentTemplate="{StaticResource ProgressDataTemplate}" />
                                    </Border>
                                    <Border Background="{StaticResource LightColorBrush}"
                                            BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                            BorderThickness="0">
                                        <TextBlock HorizontalAlignment="Center"
                                                   VerticalAlignment="Center">
                                            <Run Text="{Binding Total_RemainingTime, Mode=OneWay, StringFormat=\{0:D\}}" />
                                            <Run Text="{DynamicResource 分}" />
                                        </TextBlock>
                                    </Border>
                                </local:AutoGrid>
                            </GroupBox>
                        </Grid>
                        <GroupBox Grid.Row="1"
                                  Margin="4,0,4,4">
                            <GroupBox.Header>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Margin="8,0"
                                               Foreground="White"
                                               Visibility="{Binding OvenInfo.StartTime, Converter={StaticResource DateTimeCheckVis}, Mode=OneWay}">
                                        <Run Text="{DynamicResource 開始時間}" />
                                        <Run Text=":" />
                                        <Run Text="{Binding OvenInfo.StartTime, Mode=OneWay, StringFormat=\{0:yy/MM/dd HH:mm:ss\}}" />
                                    </TextBlock>
                                    <TextBlock Grid.Column="1"
                                               Margin="8,0"
                                               Foreground="White"
                                               Visibility="{Binding OvenInfo.EndTime, Converter={StaticResource DateTimeCheckVis}, Mode=OneWay}">
                                        <Run Text="{DynamicResource 結束時間}" />
                                        <Run Text=":" />
                                        <Run Text="{Binding OvenInfo.EndTime, Mode=OneWay, StringFormat=\{0:yy/MM/dd HH:mm:ss\}}" />
                                    </TextBlock>
                                </Grid>
                            </GroupBox.Header>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="240" />
                                    <ColumnDefinition />
                                </Grid.ColumnDefinitions>
                                <DataGrid x:Name="dg"
                                          AutoGenerateColumns="False"
                                          BorderThickness="0,0,1,0"
                                          FontSize="12"
                                          HorizontalScrollBarVisibility="Disabled"
                                          ItemsSource="{Binding OvenInfo.EventList, Mode=OneWay, IsAsync=True}"
                                          SelectedCellsChanged="SelectedCellsChanged"
                                          SelectedIndex="{Binding Items.Count, ConverterParameter=-1, Converter={StaticResource AddValue}, Mode=OneWay, RelativeSource={RelativeSource Self}}">
                                    <DataGrid.RowHeaderTemplate>
                                        <DataTemplate>
                                            <Border x:Name="Border"
                                                    Width="5"
                                                    BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                    BorderThickness="0,0,1,1" />
                                            <DataTemplate.Triggers>
                                                <DataTrigger Binding="{Binding DataContext.(models:LogEvent.Type), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGridRowHeader}}}"
                                                             Value="Normal">
                                                    <Setter TargetName="Border" Property="Background" Value="{StaticResource OKBrush}" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding DataContext.(models:LogEvent.Type), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGridRowHeader}}}"
                                                             Value="Trigger">
                                                    <Setter TargetName="Border" Property="Background" Value="Blue" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding DataContext.(models:LogEvent.Type), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGridRowHeader}}}"
                                                             Value="Operator">
                                                    <Setter TargetName="Border" Property="Background" Value="{StaticResource WorkingBrush}" />
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding DataContext.(models:LogEvent.Type), RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGridRowHeader}}}"
                                                             Value="Alarm">
                                                    <Setter TargetName="Border" Property="Background" Value="{StaticResource ErrorBrush}" />
                                                </DataTrigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>
                                    </DataGrid.RowHeaderTemplate>
                                    <DataGrid.Columns>
                                        <DataGridTemplateColumn Width="60">
                                            <DataGridTemplateColumn.Header>
                                                <TextBlock Text="{DynamicResource 歷時}" />
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate DataType="models:LogEvent">
                                                    <TextBlock Text="{Binding Time, StringFormat=\{0:hh\\:mm\\:ss\}, Mode=OneWay}" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="48">
                                            <DataGridTemplateColumn.Header>
                                                <TextBlock Text="{DynamicResource 值}" />
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate DataType="models:LogEvent">
                                                    <Grid>
                                                        <Grid.ColumnDefinitions>
                                                            <ColumnDefinition Width="Auto" />
                                                            <ColumnDefinition Width="24" />
                                                        </Grid.ColumnDefinitions>
                                                        <Ellipse x:Name="Ellipse"
                                                                 Width="10"
                                                                 Height="10"
                                                                 Margin="0,0,4,0"
                                                                 Fill="{StaticResource DisabledBackgroundBrush}"
                                                                 Stroke="{StaticResource DisabledBorderBrush}"
                                                                 StrokeThickness="1" />
                                                        <TextBlock Grid.Column="1"
                                                                   Text="{Binding Value, Mode=OneWay, Converter={StaticResource BoolOnOff}}" />
                                                    </Grid>
                                                    <DataTemplate.Triggers>
                                                        <DataTrigger Binding="{Binding Value, Mode=OneWay}"
                                                                     Value="True">
                                                            <Setter TargetName="Ellipse" Property="Fill" Value="{StaticResource WorkingBrush}" />
                                                            <Setter TargetName="Ellipse" Property="Stroke" Value="{StaticResource WorkingBorderBrush}" />
                                                        </DataTrigger>
                                                    </DataTemplate.Triggers>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                        <DataGridTemplateColumn Width="*">
                                            <DataGridTemplateColumn.Header>
                                                <TextBlock Text="{DynamicResource 事件}" />
                                            </DataGridTemplateColumn.Header>
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate DataType="models:LogEvent">
                                                    <TextBlock Text="{Binding Description, Mode=OneWay, Converter={views:StringToResource}}"
                                                               TextTrimming="CharacterEllipsis" />
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <oxy:Plot Grid.Column="1"
                                          Background="{StaticResource WindowBackgroundBrush6}"
                                          DefaultFont="Microsoft JhengHei"
                                          IsMouseWheelEnabled="False"
                                          LegendBackground="{Binding Color, Source={StaticResource LightColorBrush}}"
                                          LegendBorder="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                          LegendBorderThickness="1"
                                          LegendFontSize="12"
                                          LegendItemOrder="Reverse"
                                          LegendItemSpacing="8"
                                          LegendLineSpacing="2"
                                          LegendOrientation="Vertical"
                                          LegendPlacement="Outside"
                                          LegendPosition="RightTop"
                                          LegendTextColor="{Binding Color, Source={StaticResource BaseForeground}}"
                                          LegendTitleColor="{Binding Color, Source={StaticResource BaseForeground}}"
                                          PlotAreaBackground="{StaticResource LightColorBrush}"
                                          PlotAreaBorderColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                          PlotAreaBorderThickness="0,1,1,0"
                                          PlotMargins="40,10,0,35"
                                          TextColor="{Binding Color, Source={StaticResource BaseForeground}}">
                                    <oxy:Plot.Axes>
                                        <oxy:TimeSpanAxis Title="{DynamicResource 時間}"
                                                          AxislineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                          AxislineStyle="Solid"
                                                          ExtraGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                          ExtraGridlineStyle="Solid"
                                                          ExtraGridlineThickness="1"
                                                          IsPanEnabled="False"
                                                          IsZoomEnabled="False"
                                                          MajorGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                          MajorGridlineStyle="Dot"
                                                          MajorTickSize="0"
                                                          MaximumPadding="0"
                                                          Minimum="0"
                                                          MinimumPadding="0"
                                                          MinorGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                          MinorGridlineStyle="None"
                                                          MinorTickSize="0"
                                                          Position="Bottom"
                                                          StringFormat="hh:mm:ss"
                                                          TickStyle="Inside"
                                                          TicklineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                          TitleColor="{Binding Color, Source={StaticResource BaseForeground}}" />
                                        <oxy:LinearAxis Title="°C"
                                                        AxislineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                        AxislineStyle="Solid"
                                                        ExtraGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                        ExtraGridlineStyle="Solid"
                                                        ExtraGridlineThickness="1"
                                                        IsPanEnabled="False"
                                                        IsZoomEnabled="False"
                                                        MajorGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                        MajorGridlineStyle="Dot"
                                                        MajorStep="50"
                                                        MajorTickSize="0"
                                                        MaximumPadding="0.2"
                                                        Minimum="0"
                                                        MinimumPadding="0"
                                                        MinorGridlineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                        MinorGridlineStyle="None"
                                                        MinorTickSize="0"
                                                        Position="Left"
                                                        TickStyle="Inside"
                                                        TicklineColor="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}"
                                                        TitleColor="{Binding Color, Source={StaticResource BaseForeground}}" />
                                    </oxy:Plot.Axes>
                                    <oxy:Plot.Series>
                                        <oxy:LineSeries Title="{DynamicResource 爐內溫度8}"
                                                        DataFieldX="Time"
                                                        DataFieldY="OvenTemperatures_8"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="BurlyWood"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="BurlyWood" />
                                        <oxy:LineSeries Title="{DynamicResource 爐內溫度7}"
                                                        DataFieldX="Time"
                                                        DataFieldY="OvenTemperatures_7"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="Brown"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="Brown" />
                                        <oxy:LineSeries Title="{DynamicResource 爐內溫度6}"
                                                        DataFieldX="Time"
                                                        DataFieldY="OvenTemperatures_6"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="Magenta"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="Magenta" />
                                        <oxy:LineSeries Title="{DynamicResource 爐內溫度5}"
                                                        DataFieldX="Time"
                                                        DataFieldY="OvenTemperatures_5"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="DarkOrchid"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="DarkOrchid" />
                                        <oxy:LineSeries Title="{DynamicResource 爐內溫度4}"
                                                        DataFieldX="Time"
                                                        DataFieldY="OvenTemperatures_4"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="DodgerBlue"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="DodgerBlue" />
                                        <oxy:LineSeries Title="{DynamicResource 爐內溫度3}"
                                                        DataFieldX="Time"
                                                        DataFieldY="OvenTemperatures_3"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="Lime"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="Lime" />
                                        <oxy:LineSeries Title="{DynamicResource 爐內溫度2}"
                                                        DataFieldX="Time"
                                                        DataFieldY="OvenTemperatures_2"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="Gold"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="Gold" />
                                        <oxy:LineSeries Title="{DynamicResource 爐內溫度1}"
                                                        DataFieldX="Time"
                                                        DataFieldY="OvenTemperatures_1"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="DarkOrange"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="DarkOrange" />
                                        <oxy:LineSeries Title="{DynamicResource 溫控器溫度}"
                                                        DataFieldX="Time"
                                                        DataFieldY="ThermostatTemperature"
                                                        ItemsSource="{Binding OvenInfo.RecordTemperatures, Mode=OneWay}"
                                                        LineStyle="Solid"
                                                        MarkerFill="Red"
                                                        MarkerSize="3"
                                                        MarkerType="None"
                                                        StrokeThickness="2"
                                                        Color="Red" />
                                    </oxy:Plot.Series>
                                    <oxy:Plot.Annotations>
                                        <oxy:LineAnnotation ClipText="False"
                                                            DataContext="{Binding SelectedItem, ElementName=dg, Mode=OneWay}"
                                                            FontSize="12"
                                                            Opacity="{Binding SelectedIndex, ElementName=dg, Converter={StaticResource IsMoreThanValue}, ConverterParameter=0, Mode=OneWay}"
                                                            StrokeThickness="{Binding SelectedIndex, ElementName=dg, Converter={StaticResource IsMoreThanValue}, ConverterParameter=0, Mode=OneWay}"
                                                            TextColor="{Binding (models:LogEvent.Type), Converter={StaticResource EventTypeToColor}, Mode=OneWay}"
                                                            TextHorizontalAlignment="Center"
                                                            TextOrientation="Horizontal"
                                                            TextVerticalAlignment="Bottom"
                                                            Type="Vertical"
                                                            X="{Binding (models:LogEvent.Time), Converter={StaticResource TimespanToDouble}, Mode=OneWay}"
                                                            Color="{Binding TextColor, RelativeSource={RelativeSource Self}}">
                                            <oxy:LineAnnotation.Text>
                                                <MultiBinding StringFormat="{}{0} ({1})">
                                                    <Binding Converter="{views:StringToResource}"
                                                             Mode="OneWay"
                                                             Path="(models:LogEvent.Description)" />
                                                    <Binding Converter="{StaticResource BoolOnOff}"
                                                             Mode="OneWay"
                                                             Path="(models:LogEvent.Value)" />
                                                </MultiBinding>
                                            </oxy:LineAnnotation.Text>
                                        </oxy:LineAnnotation>
                                    </oxy:Plot.Annotations>
                                    <oxy:Plot.DefaultTrackerTemplate>
                                        <ControlTemplate>
                                            <oxy:TrackerControl d:DataContext="{d:DesignInstance oxy:TrackerControl}"
                                                                Background="{StaticResource LightBrush}"
                                                                BorderBrush="{StaticResource WindowBackgroundBrush4}"
                                                                BorderThickness="1"
                                                                CornerRadius="0"
                                                                LineExtents="{Binding (oxyPlot:PlotElement.PlotModel).PlotArea}"
                                                                LineStroke="{StaticResource WindowBackgroundBrush}"
                                                                Position="{Binding Position}">
                                                <oxy:TrackerControl.Content>
                                                    <TextBlock Margin="4"
                                                               Foreground="{StaticResource BaseForeground}"
                                                               Text="{Binding Mode=OneWay}" />
                                                </oxy:TrackerControl.Content>
                                            </oxy:TrackerControl>
                                        </ControlTemplate>
                                    </oxy:Plot.DefaultTrackerTemplate>
                                </oxy:Plot>
                            </Grid>
                        </GroupBox>
                    </Grid>
                    <Grid Grid.Row="1"
                          Margin="4,0,4,4">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="200" />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <Button Content="{DynamicResource 返回總覽}"
                                FontSize="16">
                            <i:Interaction.Triggers>
                                <i:EventTrigger EventName="Click">
                                    <i:InvokeCommandAction Command="{Binding BackCommand, Mode=OneTime}"
                                                           CommandParameter="0" />
                                </i:EventTrigger>
                            </i:Interaction.Triggers>
                        </Button>
                        <ListBox Grid.Column="1"
                                 HorizontalContentAlignment="Center"
                                 VerticalContentAlignment="Center"
                                 AlternationCount="2147483647"
                                 ItemsSource="{Binding PLC_All, Mode=OneTime}"
                                 SelectedIndex="{Binding ViewIndex, Mode=TwoWay}">
                            <ListBox.Template>
                                <ControlTemplate>
                                    <ItemsPresenter />
                                </ControlTemplate>
                            </ListBox.Template>
                            <ListBox.ItemsPanel>
                                <ItemsPanelTemplate>
                                    <views:UniformGridWithOrientation Columns="{Binding GT.OvenCount, Source={StaticResource AuthenticatorViewModel}, Converter={StaticResource RatioValueINT}, ConverterParameter=0.5, Mode=OneWay}"
                                                                      Orientation="Vertical"
                                                                      Rows="2" />
                                </ItemsPanelTemplate>
                            </ListBox.ItemsPanel>
                            <ListBox.ItemContainerStyle>
                                <Style TargetType="ListBoxItem">
                                    <Setter Property="FocusVisualStyle" Value="{x:Null}" />
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="ListBoxItem">
                                                <Grid>
                                                    <Grid.Background>
                                                        <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                            <GradientStop Offset="0" Color="{Binding Color, Source={StaticResource LightColorBrush}}" />
                                                            <GradientStop Offset="1" Color="{Binding Color, Source={StaticResource WindowBackgroundBrush6}}" />
                                                        </LinearGradientBrush>
                                                    </Grid.Background>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="Auto" />
                                                        <ColumnDefinition />
                                                    </Grid.ColumnDefinitions>
                                                    <Border>
                                                        <Border.Background>
                                                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                <GradientStop Offset="0" Color="{Binding Color, Source={StaticResource WindowBackgroundBrush6}}" />
                                                                <GradientStop Offset="1" Color="{Binding Color, Source={StaticResource WindowBackgroundBrush4}}" />
                                                            </LinearGradientBrush>
                                                        </Border.Background>
                                                        <Grid>
                                                            <Border x:Name="Border"
                                                                    Background="Cyan"
                                                                    Opacity="0" />
                                                            <TextBlock x:Name="TextBlock"
                                                                       Margin="4,0"
                                                                       HorizontalAlignment="Center"
                                                                       VerticalAlignment="Center"
                                                                       Foreground="{StaticResource BaseForeground}"
                                                                       Text="{Binding (ItemsControl.AlternationIndex), ConverterParameter=1, Converter={StaticResource AddValue}, RelativeSource={RelativeSource TemplatedParent}, Mode=OneWay, StringFormat=\{0:00\}}" />
                                                        </Grid>
                                                    </Border>
                                                    <Border x:Name="Border2"
                                                            Grid.Column="1"
                                                            Opacity="0">
                                                        <Border.Background>
                                                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                <GradientStop Offset="0.25" Color="{Binding Color, Source={StaticResource LightColorBrush}}" />
                                                                <GradientStop Offset="1.25" Color="{Binding Color, Source={StaticResource WorkingBrush}}" />
                                                            </LinearGradientBrush>
                                                        </Border.Background>
                                                    </Border>
                                                    <Border x:Name="Border3"
                                                            Grid.Column="1"
                                                            Opacity="0">
                                                        <Border.Background>
                                                            <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                                <GradientStop Offset="0.5" Color="{Binding Color, Source={StaticResource LightColorBrush}}" />
                                                                <GradientStop Offset="1.5" Color="{Binding Color, Source={StaticResource WindowBackgroundBrush6}}" />
                                                            </LinearGradientBrush>
                                                        </Border.Background>
                                                    </Border>
                                                    <ContentPresenter Grid.Column="1" />
                                                    <VisualStateManager.VisualStateGroups>
                                                        <VisualStateGroup x:Name="CommonStates">
                                                            <VisualStateGroup.Transitions>
                                                                <VisualTransition GeneratedDuration="0:0:0.12" />
                                                            </VisualStateGroup.Transitions>
                                                            <VisualState x:Name="Normal" />
                                                            <VisualState x:Name="MouseOver">
                                                                <Storyboard>
                                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Border2"
                                                                                                   Storyboard.TargetProperty="Opacity">
                                                                        <EasingDoubleKeyFrame KeyTime="0:0:0.12"
                                                                                              Value="1" />
                                                                    </DoubleAnimationUsingKeyFrames>
                                                                </Storyboard>
                                                            </VisualState>
                                                            <VisualState x:Name="Disabled" />
                                                        </VisualStateGroup>
                                                        <VisualStateGroup x:Name="SelectionStates">
                                                            <VisualStateGroup.Transitions>
                                                                <VisualTransition GeneratedDuration="0:0:0.12" />
                                                                <VisualTransition GeneratedDuration="0"
                                                                                  To="Selected" />
                                                            </VisualStateGroup.Transitions>
                                                            <VisualState x:Name="Unselected" />
                                                            <VisualState x:Name="Selected">
                                                                <Storyboard>
                                                                    <ColorAnimationUsingKeyFrames Storyboard.TargetName="TextBlock"
                                                                                                  Storyboard.TargetProperty="Foreground.(SolidColorBrush.Color)">
                                                                        <EasingColorKeyFrame KeyTime="0:0:0.12"
                                                                                             Value="White" />
                                                                    </ColorAnimationUsingKeyFrames>
                                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Border"
                                                                                                   Storyboard.TargetProperty="Opacity">
                                                                        <EasingDoubleKeyFrame KeyTime="0:0:0.12"
                                                                                              Value="1" />
                                                                    </DoubleAnimationUsingKeyFrames>
                                                                    <DoubleAnimationUsingKeyFrames Storyboard.TargetName="Border3"
                                                                                                   Storyboard.TargetProperty="Opacity">
                                                                        <EasingDoubleKeyFrame KeyTime="0:0:0.12"
                                                                                              Value="1" />
                                                                    </DoubleAnimationUsingKeyFrames>
                                                                </Storyboard>
                                                            </VisualState>
                                                        </VisualStateGroup>
                                                    </VisualStateManager.VisualStateGroups>
                                                </Grid>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </ListBox.ItemContainerStyle>
                            <ListBox.ItemTemplate>
                                <DataTemplate>
                                    <Grid TextElement.FontSize="12"
                                          TextElement.Foreground="{StaticResource BaseForeground}">
                                        <ProgressBar x:Name="Progress"
                                                     BorderThickness="0"
                                                     Maximum="1"
                                                     Style="{StaticResource ProgressBarNoText}"
                                                     Value="{Binding Progress, Mode=OneWay}" />
                                        <Border Visibility="{Binding OnlineStatus, Mode=OneWay, Converter={StaticResource BoolNotVis}}">
                                            <Border.Background>
                                                <LinearGradientBrush StartPoint="0.5,0" EndPoint="0.5,1">
                                                    <GradientStop Offset="0" Color="{Binding Color, Source={StaticResource DisabledBackgroundBrush}}" />
                                                    <GradientStop Offset="1" Color="{Binding Color, Source={StaticResource DisabledBorderBrush}}" />
                                                </LinearGradientBrush>
                                            </Border.Background>
                                            <TextBlock HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Foreground="{StaticResource DisabledForegroundBrush}"
                                                       Text="{DynamicResource 離線}" />
                                        </Border>
                                        <TextBlock x:Name="TextBlock"
                                                   HorizontalAlignment="Center"
                                                   VerticalAlignment="Center"
                                                   Text="{DynamicResource 待命}"
                                                   Visibility="{Binding OnlineStatus, Mode=OneWay, Converter={StaticResource BoolVis}}" />
                                    </Grid>
                                    <DataTemplate.Triggers>
                                        <DataTrigger Binding="{Binding IsRecording, Mode=OneWay}"
                                                     Value="True">
                                            <Setter TargetName="TextBlock" Property="Text" Value="{Binding Total_RemainingTime, Mode=OneWay, StringFormat=-\{0:D\} m}" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                                                     Value="-1">
                                            <Setter TargetName="TextBlock" Property="Foreground" Value="{StaticResource DisabledForegroundBrush}" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                                                     Value="0">
                                            <Setter TargetName="Progress" Property="Background" Value="{StaticResource WindowBackgroundBrush2}" />
                                            <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource WindowBackgroundBrush4}" />
                                            <Setter TargetName="TextBlock" Property="Foreground" Value="{StaticResource BaseForeground}" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                                                     Value="1">
                                            <Setter TargetName="Progress" Property="Background" Value="{StaticResource LightColorBrush}" />
                                            <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource WindowBackgroundBrush4}" />
                                            <Setter TargetName="TextBlock" Property="Foreground" Value="{StaticResource BaseForeground}" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                                                     Value="2">
                                            <Setter TargetName="Progress" Property="Background" Value="Yellow" />
                                            <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource EnergyBorderBrush}" />
                                            <Setter TargetName="TextBlock" Property="Foreground" Value="Red" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                                                     Value="3">
                                            <Setter TargetName="Progress" Property="Background" Value="{StaticResource WorkingBrush}" />
                                            <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource WorkingBorderBrush}" />
                                            <Setter TargetName="TextBlock" Property="Foreground" Value="Red" />
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding ProgressStatus, Mode=OneWay}"
                                                     Value="4">
                                            <Setter TargetName="Progress" Property="Background" Value="{StaticResource PressedBrush}" />
                                            <Setter TargetName="Progress" Property="BorderBrush" Value="{StaticResource PressedBorderBrush}" />
                                            <Setter TargetName="TextBlock" Property="Foreground" Value="Blue" />
                                        </DataTrigger>
                                    </DataTemplate.Triggers>
                                </DataTemplate>
                            </ListBox.ItemTemplate>
                        </ListBox>
                    </Grid>
                </Grid>
            </TabItem>
        </TabControl>
    </Grid>
</UserControl>